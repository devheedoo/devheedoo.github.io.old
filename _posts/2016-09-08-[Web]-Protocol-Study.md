# Protocol

## TCP (Transmission Control Protocol)

> TCP (Taiwan Communist Party) : 대만공산당

컴퓨터 간 데이터 통신 규약(트로토콜)의 일종이다. OSI 모형에서 4층, 전송 계층에서 사용하는 규약으로, 보통 하위 계층에서 사용하는 IP와 엮어서 TCP/IP로 표현한다. 같은 계층에서 사용하는 다른 프로토콜로 UDP가 있다.

### 개발 동기

TCP 이전에는 경로중심 통신방식이었다. 이러한 방식은 중간에 오류가 하나라도 발생하면 통신이 끊어진다. 이와 달리 TCP는 패킷교환 방식을 사용해 출발지/도착지를 정해놓고 전송하는 방식이다.

### 특징

#### 연결 설정

TCP는 전화를 거는 것처럼 **상대와 연결을 설정하고 나서 통신을 시작한다.**

1. 상대에게 통신을 하고 싶다는 메시지를 보낸다. (SYN)
2. 상대는 그 메시지에 대한 응답과 함께 자신도 통신 준비가 되었다는 메시지를 보낸다. (SYN + ACK)
3. 2번에서 받은 메시지에 응답을 보낸다. (ACK)

#### 신뢰성 보장과 흐름 제어

연결설정을 통해 통신준비를 마치면 서로 데이터를 주고받을 수 있다. 다만 네트워크를 통해 한 번에 보낼 수 있는 데이터의 양은 제한되어있으므로 분할해서 보내야 한다. 분할된 데이터에는 고유번호가 부여되어 있고, 이를 이용해 서로 확인하면서 데이터를 주고받는다.

TCP의 헤더파일을 살펴보면 목적지 주소, 확인응답, 오류 검출 및 복원, 실제데이터 등이 포함되는데 [UDP](https://namu.wiki/w/UDP)와 구분되는 것이 **확인응답(Acknowledge)** 파일이다. 이것으로 송수신시 계속 확인응답을 보내어 잘 갔는지, 잘 왔는지 확인을 하여 **데이터 신뢰도가 높다.** 하지만 이를 위한 데이터 용량이 추가되어 수신속도가 조금 떨어진다는 단점이 있다.

#### 혼잡 제어 (Congestion Control)

초기 TCP에서는 없던 요소이다. 네트워크 회선이 과다 부하를 감당하지 못하고 기능을 잃는 것을 방지하기 위해 추가된 제어 방법이다. 데이터 전송 시 상대방이 데이터를 제대로 받지 못한 것이 확인되면 데이터 전송량을 확 줄였다가 다시 조금씩 양을 늘린다. 이를 AIMD(Addictive Increase/Multicative Decrease)라고 부르며, 구체적으로 적용되는 방식은 TCP 버전마다 약간씩 차이가 있다.

결국 사용자가 많아지면 속도에서 손해를 보지만 죽지는 않게 만든 것이다.

#### 그 외 이야기

실시간성, 응답성을 중요시하는 프로그램에서는 속도가 우선시되므로 UDP를 사용한다.

## UDP (User Datagram Protocol)

컴퓨터 간 데이터 통신 규약의 일종이다. TCP와 함께 OSI 모형에서 4층, 전송 계층에 속하는 규약이다.

### 개발동기와 특징

이전에는 TCP로 통신을 하고 있었다. 이메일, 파일전송에서는 TCP가 필수불가결한 요소였으나 실시간 스트리밍 서비스에서는 걸림돌로 작용하고 있었다.

UDP의 특징은 간단하게 **TCP의 모든 신뢰성 기능이 없다**고 보면 된다. 실데이터만 포함되고 확인응답 같은 것이 없기 때문에 TCP보다 용량이 가볍고 송신속도가 빠르다. 따라서 TCP는 연결형, UDP는 비연결형이로 구분한다.

TCP의 AIMD와 같은 속도제어 기능이 없다. 때문에 데이터 과다 부하 시 네트워크 관리자 쪽에서 대역폭을 제한하거나 차단하는 방법을 사용한다.

### 활용되는 분야

스트리밍, VoIP, mVoIP 등에서 사용되고 있다. 실시간성 보장이 중요한 분야이다.

온라인 게임의 서버-클라이언트 통신에도 대부분 UDP가 사용된다. 데이터 전송 시 같은 데이터를 2개씩 보내거나, 중요한 데이터의 경우 TCP 전송을 함께 사용하기도 한다.

또한 UDP도 신뢰성 작업을 프로그래머가 직접 코딩해서 구현해 사용할 수 있다. 그 예로 비트토렌트 클라이언트에서 사용하는 μTP가 있다.

### 그 외 이야기

TCP도 옵션 설정을 통해 UDP처럼 신뢰성을 제거할 수 있다. 하지만 TCP 헤더의 길이나 형식은 유지되므로 데이터의 크기는 더 크다.