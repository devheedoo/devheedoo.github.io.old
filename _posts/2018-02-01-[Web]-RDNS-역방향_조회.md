# 2018-02-01-RDNS-역방향 조회

## 역방향 조회 이해

>  출처: https://technet.microsoft.com/ko-kr/library/cc730980(v=ws.11).aspx

- 적용 대상: Windows Server 2008, Windows Server 2008 R2

대부분의 DNS 조회에서 클라이언트는 DNS 이름을 검색하여 IP 주소를 응답받는다. 반대로 IP 주소를 검색하여 DNS 이름을 응답받을 수 있는데, 이를 역방향 조회라고 한다.

하지만 하나의 IP 주소에는 DNS 네임스페이스의 모든 도메인이 연결되어 있다. 이를 간단히 하나로 응답하기 위해 특수 도메인인 in-addr.arpa 도메인을 이용하여 역방향 조회의 응답에 사용한다.

IP 주소 표시에서 숫자의 순서를 역으로 정렬하여 in-addr.arpa 도메인 내에 하위 도메인을 형성한다. 이러한 약속은 IPv4 주소 지정을 기반으로 하는 모든 TCP/IP 네트워크에 적용된다.

## 어디에 쓰지?

역방향 조회 응답을 통해 해당 IP가 신뢰할 수 있는지 판단하기도 한다. RDNS가 설정되어 있지 않은 도메인에서 메일을 보내면 곧바로 스팸메일함으로 들어갈 수 있다는 의미다.

세계에는 IP 주소의 유효성 검사를 하는 곳들이 있고, 그러한 곳들의 사이트를 한 번에 확인해주는 사이트도 있다. http://www.anti-abuse.org 에 접속해서 자신의 메일서버 IP 주소를 입력하면 허용 또는 차단하는 곳들의 목록이 나타난다. 차단될 경우에는 보통 해당 사이트에 접속하여 원인을 알아볼 수 있다.

## 역뱡항 조회 영역 생성하기

이 과정은 111.222.333.xxx 범위 전체 IP를 할당받은 기관 또는 업체만 설정할 수 있다. 전체를 할당받았는지 확인하려면 자신의 IP 주소를 whois.kisa.or.kr에 검색해서 확인해보면 된다.

필자의 경우 웹방화벽 업체가 한 단계 더 상위에 자리하고 있었다. 웹방화벽 업체가 111.222.333.xxx 전체를 관리하고, 필자의 회사는 111.222.333.0 ~ 111.222.333.63까지 할당받았다.

이 외의 경우에는 상위 도메인 관리 기관에 연락해야 한다. 예를 들면 웹방화벽 관리 업체 또는 KT, SKT, LGT와 같은 최상위 통신 업체가 있다.

### DNS 관리자에서 역방향 조회 영역 생성하기 (Windows Server 2012 R2)

1. 역방향 조회 영역 > 새 영역 > 주 영역 > IPv4 앞부분 공통 3단계까지 적는다. 다음 누르다가 완료.
2. 역방향 조회 영역 안에 xxx.xxx.xxx.in-addr.arpa라는 표준 주영역이 생성된다. 더블 클릭해서 들어간다.
3. SOA, NS가 보인다. 빈 공간을 우클릭 > 새 PTR(포인터) > 호스트 IP 주소에 IP 주소를, 호스트 이름에 도메인명을 적는다.

